% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_lw.R
\name{fit_lw}
\alias{fit_lw}
\title{Fit Length-Weight Relationship using Log-Linear Regression}
\usage{
fit_lw(length, weight, bias_adjustment = TRUE)
}
\arguments{
\item{length}{A numeric vector of lengths}

\item{weight}{A numeric vector of weights}

\item{bias_adjustment}{Logical indicating whether to apply bias adjustment
when back-transforming the intercept (default TRUE). The bias adjustment
corrects for the systematic underestimation that occurs when exponentiating
the mean of log-transformed data.}
}
\value{
An object of class \code{c("lw_fit", "glm", "lm")} containing:
\item{coefficients}{Model coefficients on log scale}
\item{bias_adjustment}{Logical indicating if bias adjustment was applied}
\item{lw_params}{Named vector with 'a' and 'b' parameters on original scale}
}
\description{
This function fits a length-weight relationship of the form W = a * L^b using
log-linear regression. The model is fitted as log(W) = log(a) + b * log(L),
with optional bias adjustment for back-transformation.
}
\details{
The length-weight relationship is a fundamental allometric relationship in
fisheries biology, typically expressed as:

\deqn{W = a \cdot L^b}

where W is weight, L is length, 'a' is a scaling coefficient, and 'b' is the
allometric exponent. For isometric growth, b = 3.

The model is fitted using ordinary least squares regression on log-transformed
data:

\deqn{\log(W) = \log(a) + b \cdot \log(L)}

When bias_adjustment = TRUE, the intercept 'a' is calculated as:

\deqn{a = \exp(\hat{\alpha} + \frac{\sigma^2}{2})}

where \eqn{\hat{\alpha}} is the estimated intercept and \eqn{\sigma^2} is the
residual variance. This correction accounts for the fact that
\eqn{E[\exp(X)] \neq \exp(E[X])} for random variables.
}
\examples{
\dontrun{
# Simulate length-weight data
set.seed(123)
length <- runif(100, 10, 50)
weight <- 0.01 * length^3 * exp(rnorm(100, 0, 0.1))

# Fit the model
fit <- fit_lw(length = length, weight = weight)

# Get parameters
get_lw_params(fit)

# Predict weights for new lengths
predict_lw(fit, new_length = c(20, 30, 40))
}

}
\references{
Froese, R. (2006). Cube law, condition factor and weight-length relationships:
history, meta-analysis and recommendations. Journal of Applied Ichthyology,
22(4), 241-253.
}
\seealso{
\code{\link{get_lw_params}}, \code{\link{predict_lw}}, \code{\link{summary.lw_fit}}
}
