% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_vb_mle.R
\name{fit_vb_mle}
\alias{fit_vb_mle}
\title{Fit von Bertalanffy Growth Function using Maximum Likelihood Estimation}
\usage{
fit_vb_mle(
  age,
  length,
  sex = NULL,
  length_bins = NULL,
  sampling_prob = 1,
  ci_level = 0.95,
  optim_method = "L-BFGS-B",
  maxit = 1000
)
}
\arguments{
\item{age}{A numeric vector of ages}

\item{length}{A numeric vector of lengths}

\item{sex}{An optional factor or character vector specifying the sex for each observation}

\item{length_bins}{Optional numeric vector specifying length bins for analysis}

\item{sampling_prob}{Optional vector of sampling probabilities (defaults to 1)}

\item{ci_level}{Confidence interval level (default 0.95)}

\item{optim_method}{Optimization method for stats::optim (default "L-BFGS-B")}

\item{maxit}{Maximum number of iterations for optimization (default 1000)}
}
\value{
A list containing:
\item{parameters}{Estimated parameters with confidence intervals}
\item{data}{Original data with fitted values and residuals}
\item{fits}{Model fit predictions for plotting}
\item{model}{The fitted model object with optimization results}
}
\description{
This function fits a von Bertalanffy growth function to age and length data using
maximum likelihood estimation. The CV of the length is explicitly modeled as a function
of the mean length, allowing for heteroscedasticity where variance increases with fish size.
}
\examples{
\dontrun{
# Simple example with simulated data
age <- 1:15
length <- 100 * (1 - exp(-0.2 * (age - (-0.5)))) + rnorm(15, 0, 5 + 0.1 * (1:15))
fit <- fit_vb_mle(age = age, length = length)
}

}
