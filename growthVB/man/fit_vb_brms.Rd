% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_vb_brms.R
\name{fit_vb_brms}
\alias{fit_vb_brms}
\title{Fit von Bertalanffy Growth Function using Bayesian Methods (brms)}
\usage{
fit_vb_brms(
  age,
  length,
  sex = NULL,
  priors = NULL,
  prior_overrides = NULL,
  chains = 4,
  iter = 4000,
  cores = chains,
  parallel_sex = TRUE,
  ...
)
}
\arguments{
\item{age}{A numeric vector of ages}

\item{length}{A numeric vector of lengths}

\item{sex}{An optional factor or character vector specifying the sex for each observation}

\item{priors}{Optional brms prior object/list for the model parameters. If provided, this replaces defaults entirely.}

\item{prior_overrides}{Optional named character vector or list to selectively override default priors
for specific non-linear parameters. Names must be in c("Linf","k","t0","CV"). Values are prior
specification strings accepted by brms (e.g. "normal(120, 30)"). Ignored if \code{priors} is supplied.}

\item{chains}{Number of MCMC chains (default 4)}

\item{iter}{Number of iterations for each chain (default 4000)}

\item{cores}{Number of CPU cores to use for parallel processing (default: number of chains)}

\item{parallel_sex}{Logical. If TRUE and sex-specific models are being fit, run models for different sexes in parallel (default TRUE)}

\item{...}{Additional arguments passed to brms::brm()}
}
\value{
A list containing:
\item{models}{The brms model object(s)}
\item{parameters}{Summary of parameter estimates}
\item{predictions}{Predictions for plotting}
\item{data}{Original data with fitted values and residuals, including ID column preserving input order}
}
\description{
This function fits a von Bertalanffy growth function to age and length data using
Bayesian methods via the brms package. The CV of the length is modeled as a function
of the mean length.
}
\examples{
\dontrun{
# Simple example with simulated data
age <- 1:15
length <- 100 * (1 - exp(-0.2 * (age - (-0.5)))) + rnorm(15, 0, 5)
fit <- fit_vb_brms(age = age, length = length)

# Sex-specific models run in parallel
sex <- rep(c("M", "F"), length.out = 15)
fit_sex <- fit_vb_brms(age = age, length = length, sex = sex, parallel_sex = TRUE)

# Example with selective prior overrides (modify specific parameters)
# Override only Linf and k priors, keep default t0 and CV priors
fit_override <- fit_vb_brms(
  age = age, length = length,
  prior_overrides = list(
    Linf = "normal(120, 20)", # More informative prior for Linf
    k = "gamma(2, 10)" # Gamma prior for k (ensures positive)
  )
)

# Example with completely custom priors (replaces all defaults)
library(brms)
custom_priors <- c(
  prior_string("normal(110, 15)", nlpar = "Linf", lb = 0),
  prior_string("gamma(3, 15)", nlpar = "k", lb = 0),
  prior_string("normal(-0.5, 0.5)", nlpar = "t0"),
  prior_string("gamma(2, 20)", nlpar = "CV", lb = 0)
)
fit_custom <- fit_vb_brms(
  age = age, length = length,
  priors = custom_priors
)

# Example combining sex-specific models with custom priors
fit_sex_custom <- fit_vb_brms(
  age = age, length = length, sex = sex,
  prior_overrides = list(
    Linf = "normal(130, 25)", # Expect larger maximum length
    CV = "gamma(1.5, 15)" # More constrained CV
  ),
  parallel_sex = TRUE
)
}

}
